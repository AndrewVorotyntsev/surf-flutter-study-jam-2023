# Целевая платформа

Android

# Результаты

Был реализован экран хранилища билетов. Вверху экрана находится аппбар. 
У экрана есть два состояния - 
- заглушка в виде текста по центру экрана в случае, если пользователь еще не добавил билеты
- и список билетов, которые представлены в виде карточек. 

Внизу экрана находится кнопка, которая позволяет добавлять новые билеты. Она исчезает с экрана, когда пользователь пролистывает до конца списка. При нажатии на нее открывает окно, в котором необходимо ввести название и ссылку на билет. Поле со ссылкой валидируется с помощью регулярного выражения. Под полем выводится сообщение об ошибке валидации. Кнопка для добавления доступна для нажатия только тогда, когда введена корректная ссылка. После нажатия на нее билет добавляется в локальную базу данных и отображается на экране. В то же время добавляется снекбар, оповещающий об успехе добавления. 

Виджет билета содержит название билета, индикатор загрузки и кнопку в виде иконки. После добавления и до того как файл не будет загружен будет показан статус "Ожидает начала загрузки". 
Нажатие на иконку справка начинает загрузку. После этого виджет линейного индикатора показывает прогресс (не в финальной версии, см. Известные проблемы), а также под ним отображается информация о объеме загруженой части и общего объема файла в мегабайтах. В это время иконка кнопки меняется на иконку паузы (но пауза и остановка загрузки не реализована).

После загрузки статус меняется на "Загружено" и иконка меняется на изображение файла. Нажатие на нее открывает отдельный экран, на котором отображется сохраненный файл PDF. В аппбаре этого экрана есть кнопка, которая возвращает на предыдущий экран. Контент PDF можно увеличивать с помощью жестов и пролистывать, если он многостраничный.

Все билеты хранятся в локальном хранилище и сохраняются после перезахода в приложение. Загруженные файлы также хранятся на устройстве и нет необходимости загружать их заново.

Билеты можно удалить из локального хранилища с помощью свайпа. Если предварительно был загружен файл, он также будет удален из файловой системы.

Список билетов всегда отсортирован в порядке добавления.

# Ссылки на демонстрацию работы/скриншоты

## Пустой экран
<img src="https://user-images.githubusercontent.com/48821142/230798506-2c7a39fc-bcbb-4ef2-8163-72e79e060173.jpg" width="375"  />

## Список билетов
<img src="https://user-images.githubusercontent.com/48821142/230798517-1f12d2f7-7622-4397-8e19-5481a2523f6b.jpg" width="375"  />

## Диалог добавление билета
<img src="https://user-images.githubusercontent.com/48821142/230798533-2114f1c0-0d2b-4af0-9aeb-077a3a5970bf.jpg" width="375"  />

## Валидация ссылки
<img src="https://user-images.githubusercontent.com/48821142/230798540-a4086492-8b97-44ef-b4a5-3c9e1959af66.jpg" width="375"  />

## Добавление билета

https://user-images.githubusercontent.com/48821142/230799449-e231c6f6-2d88-47fc-a469-94504a203944.mp4

## Исчезновение кнопки

https://user-images.githubusercontent.com/48821142/230798817-de0942df-05d6-426b-ab33-77ca25809d16.mp4

## Загрузка файла

https://user-images.githubusercontent.com/48821142/230798833-5febd126-25b1-492c-a3fb-333e7645d874.mp4

## Просмотр файла

https://user-images.githubusercontent.com/48821142/230798852-20c84ab0-6d79-4c0e-8998-88bcbe6b043a.mp4

## Сохранение файла

https://user-images.githubusercontent.com/48821142/230799546-22b89ae4-ffad-4ee4-a234-ae98bb92f563.mp4

## Удаление файла

https://user-images.githubusercontent.com/48821142/230798984-feeeb81f-5472-4a89-a167-2398cb8795ac.mp4


# Известные проблемы

В финальной версии некорректно работает виджет линейного индикатора прогресса.
В ранней версии (в предыдущих комитах) он работал нормально, но в одной из последних правок была допущена ошибка (некорректная проверка на null) в написании геттера для значения прогресса
Файл `download_helper.dart` строка

double get progress => count != null && total != ~~total~~ null ? count! / total! : 0;

## Демонстрация работы индикатора в ранеей версии
https://user-images.githubusercontent.com/48821142/230799587-f978d7e7-d254-4745-a556-16328dec344a.mp4


